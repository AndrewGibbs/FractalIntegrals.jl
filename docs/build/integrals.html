<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Integrals · FractalIntegrals.jl</title><meta name="title" content="Integrals · FractalIntegrals.jl"/><meta property="og:title" content="Integrals · FractalIntegrals.jl"/><meta property="twitter:title" content="Integrals · FractalIntegrals.jl"/><meta name="description" content="Documentation for FractalIntegrals.jl."/><meta property="og:description" content="Documentation for FractalIntegrals.jl."/><meta property="twitter:description" content="Documentation for FractalIntegrals.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.png" alt="FractalIntegrals.jl logo"/><img class="docs-dark-only" src="assets/logo-dark.png" alt="FractalIntegrals.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">FractalIntegrals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="geometry.html">Fractals</a></li><li class="is-active"><a class="tocitem" href="integrals.html">Integrals</a><ul class="internal"><li><a class="tocitem" href="#Quadrature-rules"><span>Quadrature rules</span></a></li><li><a class="tocitem" href="#Tensor-product-quadrature"><span>Tensor product quadrature</span></a></li><li><a class="tocitem" href="#Singular-integrals"><span>Singular integrals</span></a></li></ul></li><li><a class="tocitem" href="integralequations.html">Integral Equations</a></li><li><a class="tocitem" href="refs.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="integrals.html">Integrals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="integrals.html">Integrals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AndrewGibbs/FractalIntegrals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AndrewGibbs/FractalIntegrals.jl/blob/main/docs/src/integrals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Integrals-on-fractals"><a class="docs-heading-anchor" href="#Integrals-on-fractals">Integrals on fractals</a><a id="Integrals-on-fractals-1"></a><a class="docs-heading-anchor-permalink" href="#Integrals-on-fractals" title="Permalink"></a></h1><p>In <a href="geometry.html">the previous section</a> we saw how to define a fractal measure <span>$\mu$</span> supported on some fractal attractor <span>$\Gamma$</span>. Equipped with this measure, we can define the integral</p><pre><code class="language-math hljs">I_\mu[f] := \int_\Gamma~ f(x)~ \mathrm{d}\mu(x),</code></pre><p>for some function <span>$f$</span>.</p><p>eq [#yourmathlabel]</p><h2 id="Quadrature-rules"><a class="docs-heading-anchor" href="#Quadrature-rules">Quadrature rules</a><a id="Quadrature-rules-1"></a><a class="docs-heading-anchor-permalink" href="#Quadrature-rules" title="Permalink"></a></h2><p>In general, <span>$I$</span> cannot be computed exactly. We must use <em>quadrature rules</em> to approximate <span>$I$</span>; these consist of nodes <span>$x_j$</span> and weights <span>$w_j$</span> for <span>$j=1,\ldots,N$</span> such that</p><p class="math-container">\[I_\mu[f] \approx Q_\mu[f]:=\sum_{j=1}^N f(x_j)~ w_j\]</p><p>for non-fractal domains and measures which are sufficiently simple, a range of quadrature rules are available. See for example, <a href="https://juliaapproximation.github.io/FastGaussQuadrature.jl/stable/"><code>FastGaussQuadrature</code></a> or <a href="https://juliamath.github.io/QuadGK.jl/stable/"><code>QuadGK</code></a>.</p><p>In recent decades, quadrature rules have been developed for fractal measures <span>$\mu$</span>. These have been implemented in <code>FractalIntegrals</code>.</p><p>!!!note</p><pre><code class="nohighlight hljs">Contrary to classical quadrature rules, the nodes typically lie outside of $\Gamma$. Therefore, it is necessary to assume that $f$ is supported on $\mathrm{Hull}(\Gamma)$.</code></pre><h3 id="Gauss-Quadrature"><a class="docs-heading-anchor" href="#Gauss-Quadrature">Gauss Quadrature</a><a id="Gauss-Quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Gauss-Quadrature" title="Permalink"></a></h3><p>On standard domains, Gaussian qudarature rules are the most widely used for smooth <span>$f$</span>. The classical process, which involves constructing orthogaonl polynomials and a Jacobi matrix, was generalised in [<a href="refs.html#Ma:96">2</a>] to fractal measures <span>$\mu$</span> where </p><p class="math-container">\[\mathrm{supp}(\mu) = \Gamma \subset \mathbb{R}.\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FractalIntegrals.gauss_quadrule" href="#FractalIntegrals.gauss_quadrule"><code>FractalIntegrals.gauss_quadrule</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">x, w = gauss_quadrule(μ::AbstractInvariantMeasure, n::Integer)
x, w = gauss_quadrule(Γ::AbstractAttractor, n::Integer)</code></pre><p>Returns <code>n</code> Gaussian weights <code>w ∈ ℝⁿ</code> and nodes <code>x ∈ ℝⁿ</code>. Here n is the order of the Gauss rule, i.e. number of weights and nodes.</p><p>This is based on the algorithm introduced in: &quot;A stable Stieltjes technique for computing orthogonal polynomials     and Jacobi matrices associated with a class of singular measures&quot;, Mantica, 1996. As in this paper, the algorithm is only defined for measures and attractors in one ambient dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AndrewGibbs/FractalIntegrals.jl/blob/eba39be3da5ed2d1da47be036e51170dd0f7f485/src/quadrature/gauss.jl#L2-L14">source</a></section></article><h3 id="Barycentre-rule"><a class="docs-heading-anchor" href="#Barycentre-rule">Barycentre rule</a><a id="Barycentre-rule-1"></a><a class="docs-heading-anchor-permalink" href="#Barycentre-rule" title="Permalink"></a></h3><p>Despite its simplicity, the Barycentre rule was introduced relatively recently in [<a href="refs.html#GiHeMo:23">3</a>]. It can be interpreted as a generalisation of the midpoint rule to non-standard domains.</p><p>The idea behind this quadrature rule is to subdivide the fractal <span>$\Gamma = \mathrm{supp}(\mu)$</span> into self-similar subcomponents no wider than some parameter <span>$h&gt;0$</span>. A node is allocated for each subcomponent <span>$\Gamma_{\mathbf{m}}$</span>; this node is chosen to be the barycentre</p><p class="math-container">\[\int_{\Gamma_{\mathbf{m}}} x ~\mathrm{d}\mu(x)~/~\mu(\Gamma),\]</p><p>which ensures an <span>$O(h^2)$</span> convergence rate. The reason for this is analagous to the reason that the midpoint rule converges at <span>$O(h^2)$</span>, because the linear errors above and below the midpoint cancel. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FractalIntegrals.barycentre_quadrule" href="#FractalIntegrals.barycentre_quadrule"><code>FractalIntegrals.barycentre_quadrule</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">x, w = barycentre_quadrule(μ::AbstractInvariantMeasure, h::Real)
x, w = barycentre_quadrule(Γ::AbstractAttractor, h::Real)</code></pre><p>Subdivides the support <code>Γ</code> of the measure <code>μ</code> into self-similar components, no bigger than diameter <code>h</code>, and allocates quadrature points at the barycentre of each, with weights corresponding to the respective measure of each subcomonent.</p><p>If an attractor Γ is provided, Hausdorff measure is assumed.</p><p>This is based on the method introduced in: &quot;Numerical quadrature for singular integrals on fractals&quot;, A. Gibbs, D. P. Hewett, A. Moiola, 2022.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AndrewGibbs/FractalIntegrals.jl/blob/eba39be3da5ed2d1da47be036e51170dd0f7f485/src/quadrature/barycentrerule.jl#L14-L27">source</a></section></article><pre><code class="language-julia hljs"># define invariant measure on Koch snowflake
Γ = getfractal(&quot;koch snowflake&quot;)

# get some random probability weights
p = abs.(0.5.+randn(7)/5)
# rescale the first weight due to larger size of central component
p[1] = p[1]*sqrt(3)
p = p/sum(p)

# define the invariant measure
μ = InvariantMeasure(Γ, p)

# get barycentre rule quadrature weights and nodes
h_bary = 0.01
x_bary, w_bary = FractalIntegrals.barycentre_quadrule(μ, h_bary)

# plot the distribution of weights over the snowflake
plot([x_[1] for x_ in x_bary],[x_[2] for x_ in x_bary],
    linewidth=0,
    markersize=1,
    markershape=:circle,
    markerstrokewidth=0,
    marker_z = log.(w_bary),
    axis=false,
    grid=false,
    legend = false,
    aspect_ratio=1,
    ylim=(-0.6,0.6),
    xlim=(-0.875,0.875),
    size = (875, 875),
    background=nothing)</code></pre><img src="integrals-57e93b82.svg" alt="Example block output"/><h3 id="Chaos-game-quadrature"><a class="docs-heading-anchor" href="#Chaos-game-quadrature">Chaos game quadrature</a><a id="Chaos-game-quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Chaos-game-quadrature" title="Permalink"></a></h3><p><em>Chaos game quadrature</em> [<a href="refs.html#FoMeVr:98">4</a>] is a non-deterministic approach, analagous to Monte Carlo rules. The algorithm takes an initial guess <span>$x_0\in\mathbb{R}^n$</span> and repeatedly applies similarities <span>$s_m$</span> at random to construct further points. Mathematically, this is:</p><p class="math-container">\[\mathbb{P}(x_{j} = s_m(x_{j-1})) = p_m,\quad\text{for }m=1,\ldots,M.\]</p><p>The random process above is repeated for <span>$j=1,\ldots,N$</span>; the weights are simply <span>$1/N$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FractalIntegrals.chaos_quadrule" href="#FractalIntegrals.chaos_quadrule"><code>FractalIntegrals.chaos_quadrule</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">x, w = chaos_quadrule(μ::AbstractInvariantMeasure, n::Int)
x, w = chaos_quadrule(Γ::AbstractAttractor, n::Int)</code></pre><p>Randomly allocates quadrature nodes based on the probability weights of the invariant measure <code>μ</code>. Quadrature weights are uniformly <code>1/n</code></p><p>If an attractor Γ is provided, Hausdorff measure is assumed.</p><p>This is based on the method introduced in: Forte, B., Mendivil, F., Vrscay, E.: &quot;Chaos games for iterated function systems with grey level maps&quot;, 1998.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AndrewGibbs/FractalIntegrals.jl/blob/eba39be3da5ed2d1da47be036e51170dd0f7f485/src/quadrature/chaos.jl#L2-L15">source</a></section></article><pre><code class="language-julia hljs"># get the chaos game points
n_chaos = length(x_bary)
x_chaos, w_chaos = FractalIntegrals.chaos_quadrule(μ, n_chaos)

# plot the distribution of points
plot([x_[1] for x_ in x_chaos],[x_[2] for x_ in x_chaos],
    linewidth=0,
    markersize=0.7,
    markershape=:circle,
    markerstrokewidth=0,
    axis=false,
    grid=false,
    legend = false,
    aspect_ratio=1,
    ylim=(-0.6,0.6),
    xlim=(-0.875,0.875),
    size = (875, 875),
    background=nothing)</code></pre><img src="integrals-dffbe6a3.svg" alt="Example block output"/><h2 id="Tensor-product-quadrature"><a class="docs-heading-anchor" href="#Tensor-product-quadrature">Tensor product quadrature</a><a id="Tensor-product-quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-product-quadrature" title="Permalink"></a></h2><h2 id="Singular-integrals"><a class="docs-heading-anchor" href="#Singular-integrals">Singular integrals</a><a id="Singular-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Singular-integrals" title="Permalink"></a></h2><p>The quadrature rules described <a href="integrals.html#quadrature-rules">above</a> require some smoothness of the integrand <span>$f$</span> to be accurate. We now consider a class of singular integrals:</p><p class="math-container">\[\mathcal{E}_s[\mu] := \left\{\begin{array}{cc}
    \displaystyle\int_\Gamma\int_\Gamma~ |x-y|^{-s}~ \mathrm{d}\mu(y)\mathrm{d}\mu(x),&amp; s\neq0\\&amp;\\
    \displaystyle\int_\Gamma\int_\Gamma~ \log|x-y|~ \mathrm{d}\mu(y)\mathrm{d}\mu(x),&amp; s=0
    \end{array}
    \right.\]</p><p>These integrals are sometimes referred to as <em>s-energy</em> [<a href="refs.html#Fa:14">5</a>, Section 4.3] or the <em>generalised electrostatic potential</em> [<a href="refs.html#MaVa:07">6</a>, Definition 4]. They are of significant interest in their own right, but also arise in integral equations posed on fractals, thus forming a key part of our integral equation solver.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FractalIntegrals.s_energy" href="#FractalIntegrals.s_energy"><code>FractalIntegrals.s_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s_energy(  μ::AbstractInvariantMeasure, s::Number)
s_energy(  μ₁::AbstractInvariantMeasure, μ₂::AbstractInvariantMeasure, s::Number)</code></pre><p>Computes the s-energy of the measure μ, or possibly of two measures (with shared support) μ₁ and μ₂. The integrand is <code>|x-y|ˢ</code> when <code>s</code> is different from zero, and <code>log|x-y|</code> when <code>s=0</code>.</p><p><strong>Optional Inputs</strong></p><ul><li><code>h_quad</code>: Uses barycentre to evaluate integrals, with this parameter</li><li><code>N_quad</code>: Uses gauss rule to evaluate integrals, with this parameter</li><li><code>quadrule</code>: Evaluates s-energy with this 3-tuple of (x-nodes, y-nodes, weights). This quadrature rule should be designed for smooth integrals.</li><li><code>use_strategy_two</code>: When true, the algorithm subdivides the fractal so all elements are a similar size. When false, each component is subdivided the same number of times, but the sizes may vary significantly.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AndrewGibbs/FractalIntegrals.jl/blob/eba39be3da5ed2d1da47be036e51170dd0f7f485/src/quadrature/senergy.jl#L282-L293">source</a></section></article><p>The algorithm, which was introduced in [<a href="refs.html#GiHeMa:24">7</a>], exploits self-similarity of <span>$\Gamma$</span> and scaling properties of the singular integrand. It also exploits any rotational and reflective symmetry of the measure <span>$\mu$</span>, which typically only occurs when <span>$\mu$</span> is the Hausdorff measure.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="geometry.html">« Fractals</a><a class="docs-footer-nextpage" href="integralequations.html">Integral Equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 29 October 2024 11:04">Tuesday 29 October 2024</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
